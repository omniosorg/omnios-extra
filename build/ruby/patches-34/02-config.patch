# Ensure we correctly identify a 64-bit build and
# use "amd64" and "sparcv9" for the 64-bit cpu string.
# Changes were developed in-house, are Solaris specific,
# and are not suitable for upstream.

diff -wpruN --no-dereference '--exclude=*.orig' a~/tool/config.guess a/tool/config.guess
--- a~/tool/config.guess	1970-01-01 00:00:00
+++ a/tool/config.guess	1970-01-01 00:00:00
@@ -440,7 +440,7 @@ case $UNAME_MACHINE:$UNAME_SYSTEM:$UNAME
 		(CCOPTS="" $CC_FOR_BUILD -m64 -E - 2>/dev/null) | \
 		grep IS_64BIT_ARCH >/dev/null
 	    then
-		SUN_ARCH=x86_64
+		SUN_ARCH=amd64
 	    fi
 	fi
 	SUN_REL=`echo "$UNAME_RELEASE" | sed -e 's/[^.]*//'`
diff -wpruN --no-dereference '--exclude=*.orig' a~/tool/config.sub a/tool/config.sub
--- a~/tool/config.sub	1970-01-01 00:00:00
+++ a/tool/config.sub	1970-01-01 00:00:00
@@ -1033,7 +1033,7 @@ case $cpu-$vendor in
 
 	# Here we normalize CPU types irrespective of the vendor
 	amd64-*)
-		cpu=x86_64
+		# don't change basic_machine
 		;;
 	blackfin-*)
 		cpu=bfin
